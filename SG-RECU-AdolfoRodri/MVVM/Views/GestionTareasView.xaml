<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="SG_RECU_AdolfoRodri.MVVM.Views.GestionTareasView"
             xmlns:conv="clr-namespace:SG_RECU_AdolfoRodri.Converters"
             xmlns:local="clr-namespace:SG_RECU_AdolfoRodri.MVVM.ViewModels">
    <ContentPage.Resources>
        <ResourceDictionary>
            <conv:BoolToStringConverter x:Key="conversorSwitch" />
        </ResourceDictionary>
    </ContentPage.Resources>

    <Grid RowDefinitions="*, Auto">
        <ScrollView>
            <VerticalStackLayout Spacing="30" HorizontalOptions="Center" WidthRequest="800">
                <Entry Placeholder="Título..."
                       Text="{Binding TareaSeleccionada.Titulo}"
                       FontSize="18" HorizontalOptions="FillAndExpand"/>
                
                <Editor Placeholder="Descripción..."
                        Text="{Binding TareaSeleccionada.Descripción}"
                        AutoSize="TextChanges"
                        HeightRequest="100" FontSize="16"/>

                <Picker Title="Prioridad" FontSize="16"
                        SelectedItem="{Binding TareaSeleccionada.Prioridad}">
                    <Picker.ItemsSource>
                        <x:Array Type="{x:Type x:String}">
                            <x:String>Alta</x:String>
                            <x:String>Media</x:String>
                            <x:String>Baja</x:String>
                        </x:Array>
                    </Picker.ItemsSource>
                </Picker>
                
                <HorizontalStackLayout HorizontalOptions="Center" VerticalOptions="Center" Spacing="10">
                    <Label Text="Completada" VerticalOptions="Center" FontSize="16"/>
                    <Switch IsToggled="{Binding TareaSeleccionada.Estado}"/>
                </HorizontalStackLayout>

                <Label Text="Etiquetas" FontAttributes="Bold" FontSize="16" HorizontalOptions="Center"/>
                <CollectionView ItemsSource="{Binding EtiquetasDisponibles}"
                                SelectionMode="None"
                                HeightRequest="200"
                                HorizontalOptions="Center">
                    <CollectionView.EmptyView>
                        <Label Text="No hay etiquetas disponibles" HorizontalOptions="Center" VerticalOptions="Center"/>
                    </CollectionView.EmptyView>

                    <CollectionView.ItemTemplate>
                        <DataTemplate>
                            <HorizontalStackLayout Padding="5" HorizontalOptions="Center">
                                <CheckBox IsChecked="{Binding EtiquetaSelecionada}"/>
                                <Label Text="{Binding Etiqueta.Nombre}" VerticalOptions="Center"/>
                            </HorizontalStackLayout>
                        </DataTemplate>
                    </CollectionView.ItemTemplate>
                </CollectionView>
            </VerticalStackLayout>
        </ScrollView>
        <HorizontalStackLayout Grid.Row="1" Spacing="200" Margin="0,10"
                               HorizontalOptions="Center" VerticalOptions="End">
            <Button Text="Volver" 
                    WidthRequest="200" HeightRequest="80" 
                    FontAttributes="Bold" FontSize="18"
                    Command="{Binding VolverCommand}"/>
            <Button Text="Guardar" 
                    WidthRequest="200" HeightRequest="80"
                    FontAttributes="Bold" FontSize="18"
                    Command="{Binding GuardarCommand}"/>    
            <Button Text="Etiquetas" 
                    WidthRequest="200" HeightRequest="80"
                    FontAttributes="Bold" FontSize="18"
                    Command="{Binding GestionEtiquetasCommand}"/>
        </HorizontalStackLayout>
    </Grid>
</ContentPage>